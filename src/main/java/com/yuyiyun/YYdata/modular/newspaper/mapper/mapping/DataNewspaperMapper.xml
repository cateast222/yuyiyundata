<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper
	namespace="com.yuyiyun.YYdata.modular.newspaper.mapper.DataNewspaperMapper">

	<!-- 通用查询映射结果 -->
	<resultMap id="BaseResultMap"
		type="com.yuyiyun.YYdata.modular.newspaper.entity.DataNewspaper">
		<id column="uuid" property="uuid" />
		<result column="chs_name" property="chsName" />
		<result column="org_name" property="orgName" />
		<result column="full_name" property="fullName" />
		<result column="publish" property="publish" />
		<result column="type" property="type" />
		<result column="url" property="url" />
		<result column="cover" property="cover" />
		<result column="data_source" property="dataSource" />
		<result column="remark" property="remark" />
		<result column="state" property="state" />
		<result column="creator" property="creator" />
		<result column="create_time" property="createTime" />
		<result column="update_time" property="updateTime" />
	</resultMap>

	<!-- 通用查询结果列 -->
	<sql id="Base_Column_List">
		uuid AS 'uuid',
		data_source AS 'dataSource'
	</sql>

	<select id="listFromNewspaper" resultType="map">
		SELECT
		a.uuid AS 'uuid',
		a.chs_name AS 'chsName',
		a.full_name AS
		'fullName',
		date_format( a.publish, '%Y-%m-%d' ) AS 'publish',
		a.url AS
		'url',
		a.cover AS 'cover',
		a.remark AS 'remark',
		a.state AS 'state',
		(
		SELECT COUNT( uuid ) FROM data_news b WHERE a.uuid = b.data_newspaper
		)
		AS 'newsCount'
		FROM
		data_newspaper a
		WHERE 1 = 1
		<if test="dataSource!=null and dataSource!=0">
			AND a.data_source = #{dataSource}
		</if>
		<if test="condition != null and condition !=''">
			AND a.full_name like CONCAT('%',#{condition},'%')
			<!-- AND a.chs_name = #{condition} -->
		</if>
		ORDER BY a.publish DESC
	</select>
</mapper>
